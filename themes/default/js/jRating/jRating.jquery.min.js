(function(a){a.fn.jRating=function(r){var s={bigStarsPath:"../js/jRating/stars.png",smallStarsPath:"../js/jRating/stars.png",phpPath:"jrating/php/jRating.php",type:"big",step:!1,isDisabled:!1,showRateInfo:!0,canRateAgain:!1,sendRequest:!0,length:5,decimalLength:0,rateMax:20,rateInfosX:-45,rateInfosY:5,nbRates:1,onSuccess:null,onError:null,onClick:null};if(0<this.length)return this.each(function(){function j(a){var a=parseFloat(100*a/i*parseInt(b.rateMax)/100),c=Math.pow(10,parseInt(b.decimalLength));
return Math.round(a*c)/c}function k(a){return!a?0:a.offsetLeft+k(a.offsetParent)}var b=a.extend(s,r),f=0,e=0,g=0,l="",m=!1,n=0,p=b.nbRates,t=a(this).hasClass("jDisabled")||b.isDisabled?!0:!1;switch(b.type){case "small":e=12;g=10;l=b.smallStarsPath;break;default:e=23,g=20,l=b.bigStarsPath}a(this).height(g);var h=parseFloat(a(this).attr("data-average")),q=parseInt(a(this).attr("data-id")),i=e*b.length;a("<div>",{"class":"jRatingColor",css:{width:h/b.rateMax*i}}).appendTo(a(this));h=a("<div>",{"class":"jRatingAverage",
css:{width:0,top:-g}}).appendTo(a(this));a("<div>",{"class":"jStar",css:{width:i,height:g,top:-(2*g),background:"url("+l+") repeat-x"}}).appendTo(a(this));a(this).css({width:i,overflow:"hidden",zIndex:1,position:"relative"});t||a(this).unbind().bind({mouseenter:function(d){var c=k(this),c=d.pageX-c;b.showRateInfo&&a("<p>",{"class":"jRatingInfos",html:j(c)+' <span class="maxRate">/ '+b.rateMax+"</span>",css:{top:d.pageY+b.rateInfosY,left:d.pageX+b.rateInfosX}}).appendTo("body").show()},mouseover:function(){a(this).css("cursor",
"pointer")},mouseout:function(){a(this).css("cursor","default");m?h.width(n):h.width(0)},mousemove:function(d){var c=k(this),c=d.pageX-c;f=b.step?Math.floor(c/e)*e+e:c;h.width(f);b.showRateInfo&&a("p.jRatingInfos").css({left:d.pageX+b.rateInfosX}).html(j(f)+' <span class="maxRate">/ '+b.rateMax+"</span>")},mouseleave:function(){a("p.jRatingInfos").remove()},click:function(d){var c=this;m=!0;n=f;p--;(!b.canRateAgain||0>=parseInt(p))&&a(this).unbind().css("cursor","default").addClass("jDisabled");b.showRateInfo&&
a("p.jRatingInfos").fadeOut("fast",function(){a(this).remove()});d.preventDefault();var e=j(f);h.width(f);a(".datasSent p").html("<strong>idBox : </strong>"+q+"<br /><strong>rate : </strong>"+e+"<br /><strong>action :</strong> rating");a(".serverResponse p").html("<strong>Loading...</strong>");if(b.onClick)b.onClick(c,e);b.sendRequest&&a.post(b.phpPath,{idBox:q,rate:e,action:"rating"},function(d){if(d.error){if(a(".serverResponse p").html(d.server),b.onError)b.onError(c,e)}else if(a(".serverResponse p").html(d.server),
b.onSuccess)b.onSuccess(c,e)},"json")}})})}})(jQuery);


